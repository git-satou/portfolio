## yum でインストール

OSの標準レポジトリを使用するか
以下の公式ページにアクセスし、OSとバージョンを選択して表示されたコマンドを実行：

[PostgreSQL Yum Repository（公式）](https://www.postgresql.org/download/linux/redhat/)

---

## チューニング

> ※DBサーバとしての推奨値のため、他のミドルウェアがある場合は要調整

### 1. 外部接続を許可する場合

```conf
listen_addresses = 'localhost'
       ↓
listen_addresses = '*'
```

---

### 2. キャッシュメモリサイズ（テーブル・インデックス等）

推奨値：**搭載メモリの 25% 程度**

```conf
shared_buffers = 128MB
       ↓
shared_buffers = 512MB
```

---

### 3. ランダムページ読み込みコスト

目安値：**2.0〜3.0**

```conf
random_page_cost = 4.0
       ↓
random_page_cost = 2.0
```

---

### 4. ディスクキャッシュ利用の推定値

目安（搭載メモリに対して）：

| メモリ | 推奨値              |
|--------|---------------------|
| 2GB    | 512MB               |
| 4GB    | 2GB                 |
| 8GB    | 4GB                 |

```conf
effective_cache_size = 4GB
       ↓
effective_cache_size = 512MB
```

---

### 5. 自動バキュームを無効化

```conf
autovacuum = on
       ↓
autovacuum = off
```

---

### 6. クエリログの記録（1000ms 以上）

```conf
log_min_duration_statement = -1
       ↓
log_min_duration_statement = 1000
```

---

## 特定時間帯にバキュームを実行する場合

Cron で定時実行する例：

```cron
# Vacuumdb
00 03 * * * /usr/bin/vacuumdb -U postgres -avz -p 5432 > /var/log/vacuumdb.log 2>&1
```

---

## 接続数の多いデータベース用：カーネルチューニング

```conf
net.core.rmem_max = 3145728
net.core.wmem_max = 3145728
net.ipv4.tcp_max_syn_backlog = 16384
net.core.netdev_max_backlog = 16384
net.core.somaxconn = 32768
```